# Jupyter Notebook工具集帮助文档

## 版本信息

### split_ipynb.py
- **版本号**：v1.0.0
- **发布日期**：2025-11-20 09:50
- **开发环境**：Python 3.6+, 跨平台

### img2pdf.py
- **版本号**：v2.1.0
- **发布日期**：2025-11-20 17:21
- **开发环境**：Python 3.6+, 跨平台

---

## 1. 概述

本工具集包含两个Python脚本，用于简化Jupyter Notebook处理和图片转PDF的工作流程：

- **split_ipynb.py**：将大型Jupyter Notebook文件拆分为多个较小的Notebook文件
- **img2pdf.py**：将多张图片合并、切分并转换为格式规范的PDF文件

## 2. 系统要求

- **Python版本**：3.6及以上
- **操作系统**：Windows 10/11 64位系统、macOS、Linux
- **依赖库**：
  - split_ipynb.py：无需额外依赖
  - img2pdf.py：Pillow (PIL Fork), reportlab

## 3. 安装依赖

```bash
pip install pillow reportlab
```

---

## 4. split_ipynb.py - Jupyter Notebook拆分工具

### 4.1 功能介绍

将单个大型Jupyter Notebook (.ipynb) 文件拆分为多个较小的Notebook文件，支持自定义拆分规则或均匀分配单元格。

### 4.2 核心特性

- **灵活的路径输入**：支持直接输入路径或带引号的路径（含空格路径）
- **两种拆分模式**：自定义拆分数量和均匀分配
- **智能输入处理**：支持中文逗号分隔、末尾带逗号等灵活输入格式
- **详细拆分信息**：显示拆分方案和文件信息
- **自动目录创建**：如果输出目录不存在，程序自动创建

### 4.3 使用方法

运行脚本：
```bash
python split_ipynb.py
```

按照提示依次输入：
1. Jupyter Notebook文件路径
2. 每个文件的单元格数（用逗号分隔，如5,3,4；直接回车则进入均分模式）
3. 输出目录路径（可选，默认当前目录）

#### 路径输入示例

```bash
# 直接输入路径
C:\Users\User\Desktop\notebook.ipynb

# 带引号的路径（适用于含空格的路径）
"C:\Users\User\Desktop\my notebook.ipynb"
```

### 4.4 示例操作

```
请输入要拆分的ipynb文件路径（例如：test.ipynb）："C:\Users\User\Desktop\my_notebook.ipynb"

✅ 成功读取文件，该Notebook共有 232 个单元格

 目前Notebook单元格数的1/2约为 116 个单元格，
 1/3约为 77 个单元格，
 1/4约为 58 个单元格
 1/5约为 46 个单元格，
供参考

请输入每个文件的单元格数（用逗号分隔，如5,3,4；直接回车则进入均分模式）：77,77,

📊 当前共分成了 3 个文件，每个文件的单元格个数是：[77, 77, 78]

请输入输出目录（默认当前目录）：

📌 最终拆分分配方案：[77, 77, 78]
开始拆分...
已生成：1.ipynb（包含 77 个单元格）
已生成：2.ipynb（包含 77 个单元格）
已生成：3.ipynb（包含 78 个单元格）

🎉 拆分完成！
```

### 4.5 文件命名规则

拆分后的文件将以以下格式命名：
```
序号.ipynb
```

例如：`1.ipynb`、`2.ipynb`、`3.ipynb`

---

## 5. img2pdf.py - 图片转PDF工具

### 5.1 功能介绍

将多张图片按顺序合并成一个长图，计算合适的尺寸后纵向切分，最终生成格式规范的PDF文件。支持自定义PDF页面大小、边距和切片数量。

### 5.2 使用方法

程序支持两种使用方式：交互式输入和命令行参数。

#### 5.2.1 交互式输入

直接运行程序，系统会在计算出最少需要的切片数量后，提示用户输入切片数量：

```bash
python img2pdf.py
```

程序执行流程：
1. 读取 `test` 文件夹中的图片
2. 按文件名顺序合并成一个长图
3. 计算长图在宽铺满PDF时的尺寸
4. 计算最少需要的切片数量
5. 提示用户输入切片数量（必须不低于最少数量）
6. 纵向切分长图
7. 生成PDF文件

#### 5.2.2 命令行参数

通过 `--slices` 参数直接指定切片数量，无需交互式输入：

```bash
python img2pdf.py --slices 20
```

如果指定的切片数量小于最少需要的切片数量，程序会自动使用最少切片数量。

### 5.3 配置参数

可以在代码顶部修改以下超参数来自定义PDF生成效果：

| 参数名 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `INPUT_FOLDER` | str | "test" | 输入图片文件夹路径 |
| `OUTPUT_PDF` | str | "output.pdf" | 输出PDF文件路径 |
| `USER_SPECIFIED_SLICES` | int | 500 | 用户指定的切片数量，None表示使用交互式输入 |
| `PDF_MARGIN_LEFT` | float | 15 | PDF页面左侧边距（单位：mm） |
| `PDF_MARGIN_RIGHT` | float | 15 | PDF页面右侧边距（单位：mm） |
| `PDF_MARGIN_TOP` | float | 0 | PDF页面顶部边距（单位：mm） |
| `PDF_MARGIN_BOTTOM` | float | 0 | PDF页面底部边距（单位：mm） |
| `PDF_PAGE_SIZE` | tuple | A4 | PDF页面大小，默认为A4(210mm × 297mm) |

### 5.4 示例

#### 示例1：较少切片数量

```bash
python img2pdf.py --slices 15
```

- 效果：每个切片较大，基本每页一个切片
- 适用场景：需要较大字体显示或打印的场景
---

## 6. 更新日志

### split_ipynb.py 更新日志

#### v1.0.0 (2025-11-20 09:50)
- 初始版本发布
- 支持带引号路径输入
- 支持中文逗号和末尾逗号分隔
- 提供自定义拆分和均匀分配两种模式
- 自动创建输出目录

### img2pdf.py 更新日志

#### v2.1.0 (2025-11-20 12:39)
- 将PDF四周边距参数拆分为上下左右独立参数，支持更灵活的边距设置
- 修复了路径转义问题
- 优化了日志输出格式

#### v2.0.0 (2025-11-20 12:24)
- 优化PDF生成逻辑，支持每页放置多个切片
- 增加尺寸计算和缩放比例显示
- 完善交互式输入功能
- 优化用户界面和输出信息
- 修复图片排序问题

#### v1.0.0 (2025-11-20 09:50)
- 初始版本发布
- 支持多种图片格式导入
- 智能排序图片功能
- 跨页图片处理能力
- 基本的PDF生成功能

---

## 7. 联系与反馈

如有问题或建议，请联系开发者进行反馈。

---

**文档版本**：v2.0.0
**最后更新**：2025-11-20 17:21